- CSS:

<style>
        /* Colores personalizados */
        .icono-visto {
            color: black;
        }

        .icono-no-visto {
            color: gray;
        }

        /* Animación rápida al hacer clic */
        .icono-animado {
            animation: rebote 0.4s ease;
        }

        @keyframes rebote {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .estado-vista {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }

        .texto-visto {
            font-size: 1em;
            color: black; /* mismo tono que icono-visto */
            font-weight: bold;
            margin-left: 8px;
            display: inline-block;

            opacity: 1;
            visibility: visible;
            /* transition: opacity 0.7s ease, visibility 0.7s ease; */
            
            transform: translateY(0);
            transition: opacity 0.7s ease, visibility 0.7s ease, transform 0.7s ease;
        }

        .texto-visto.oculto {
            opacity: 0;
            visibility: hidden;

            transform: translateY(-5px);
        }

        .icono-confirmacion {
            margin-right: 4px;
            color: #28a745;
        }


    </style>



-HTML + PHP incrustado:

<!-- Aquí indicamos si existe Sesion, si la pelicula no está "Vista" o si la marca de "Pelicula_vista" es mía(del usuario que está logeado)
            entonces puede quitarla(cambiar/editar el estado de pelicula_vista) o sino existe ponerla. -->
        <!--    <?php if(Sesion::existeSesion()): ?>
                <?php if($peliculaVista): ?>
                    <button class="quitarVista" data-idPelicula="<?= $pelicula->getId()?>" id="botonVista">Quitar Vista</button>
                <?php else: ?>
                    <button class="ponerVista" data-idPelicula="<?= $pelicula->getId()?>" id="botonVista">Marcar Vista</button>
                <?php endif; ?>
            <?php endif; ?>
        -->

            <?php if (Sesion::existeSesion()): ?>
                <?php if ($peliculaVista): ?>
                    <i id="botonVista" class="fas fa-eye quitarVista text-success"
                    data-idPelicula="<?= $pelicula->getId() ?>"
                    style="cursor: pointer; font-size: 1.5rem;"
                    title="Quitar vista"></i>
                <?php else: ?>
                    <i id="botonVista"
                    class="fas fa-eye-slash ponerVista text-secondary"
                    data-idPelicula="<?= $pelicula->getId() ?>"
                    style="cursor: pointer; font-size: 1.5rem;"
                    title="Marcar como vista"></i>
                <?php endif; ?>
            <?php endif; ?>


            <?php if (Sesion::existeSesion()): ?>
                <?php if ($peliculaVista): ?>
                    <i id="botonVista"
                    class="fas fa-eye quitarVista icono-visto"
                    data-idPelicula="<?= $pelicula->getId() ?>"
                    style="cursor: pointer; font-size: 1.5rem;"
                    title="Quitar vista"></i>
                <?php else: ?>
                    <i id="botonVista"
                    class="fas fa-eye-slash ponerVista icono-no-visto"
                    data-idPelicula="<?= $pelicula->getId() ?>"
                    style="cursor: pointer; font-size: 1.5rem;"
                    title="Marcar como vista"></i>
                <?php endif; ?>
            <?php endif; ?>



<?php if (Sesion::existeSesion()): ?>
    <span class="estado-vista">
        <?php if ($marcadaVista): ?>
            <i id="botonVista"
               class="fas fa-eye quitarVista icono-visto"
               data-idPelicula="<?= $pelicula->getId() ?>"
               style="cursor: pointer; font-size: 1.5rem;"
               title="Quitar vista"></i>
        <?php else: ?>
            <i id="botonVista"
               class="fas fa-eye-slash ponerVista icono-no-visto"
               data-idPelicula="<?= $pelicula->getId() ?>"
               style="cursor: pointer; font-size: 1.5rem;"
               title="Marcar como vista"></i>
        <?php endif; ?>
        
        <!-- Siempre se muestra este span, visible solo si ya estaba marcada como vista -->
        <span class="texto-visto" style="<?= $marcadaVista ? '' : 'display: none;' ?>">
            <i class="fas fa-check-circle icono-confirmacion"></i> Vista
        </span>
    </span>
<?php endif; ?>




- JS:
/* Funciones para marcar y quitar película vista con AJAX asignando icono */
/* let vistaOn = document.querySelector('.quitarVista');
if(vistaOn != null){
    vistaOn.addEventListener('click', quitarVista);
}

let vistaOff = document.querySelector('.ponerVista');
if(vistaOff != null){
    vistaOff.addEventListener('click', ponerVista);
}

function ponerVista() {
    let idPelicula = this.getAttribute('data-idPelicula');
    fetch('index.php?accion=poner_pelicula_vista&id=' + idPelicula)
        .then(response => response.json())
        .then(data => {
            if (data.respuesta === 'ok') {
                console.log('Vista puesta con éxito');
                actualizarEstadoVista('vista');
                let botonVista = document.getElementById('botonVista');
                botonVista.removeEventListener('click', ponerVista);
                botonVista.addEventListener('click', quitarVista);
                botonVista.innerHTML = "Quitar Vista";
            } else {
                console.error('Error al marcar película como vista');
            }
        })
        .catch(error => {
            console.error('Error en la solicitud:', error);
        });
}

function quitarVista() {
    let idPelicula = this.getAttribute('data-idPelicula');
    fetch('index.php?accion=quitar_pelicula_vista&id=' + idPelicula)
        .then(response => response.json())
        .then(data => {
            if (data.respuesta === 'ok') {
                console.log('Vista quitada con éxito');
                actualizarEstadoVista('no_vista');
                let botonVista = document.getElementById('botonVista');
                botonVista.removeEventListener('click', quitarVista);
                botonVista.addEventListener('click', ponerVista);
                botonVista.innerHTML = "Marcar Vista";
            } else {
                console.error('Error al quitar estado de vista');
            }
        })
        .catch(error => {
            console.error('Error en la solicitud:', error);
        });
} */





let vistaOn = document.querySelector('.quitarVista');
if (vistaOn != null) {
    vistaOn.addEventListener('click', quitarVista);
}

let vistaOff = document.querySelector('.ponerVista');
if (vistaOff != null) {
    vistaOff.addEventListener('click', ponerVista);
}

function ponerVista() {
    let idPelicula = this.getAttribute('data-idPelicula');
    fetch('index.php?accion=poner_pelicula_vista&id=' + idPelicula)
        .then(response => response.json())
        .then(data => {
            if (data.respuesta === 'ok') {
                console.log('Vista puesta con éxito');
                actualizarEstadoVista('vista');

                let botonVista = document.getElementById('botonVista');
                let textoVista = document.querySelector('.texto-visto');

                botonVista.classList.add('icono-animado');
                setTimeout(() => botonVista.classList.remove('icono-animado'), 300);

                botonVista.classList.remove('ponerVista', 'icono-no-visto', 'fa-eye-slash');
                botonVista.classList.add('quitarVista', 'icono-visto', 'fa-eye');
                botonVista.setAttribute('title', 'Quitar vista');
                botonVista.removeEventListener('click', ponerVista);
                botonVista.addEventListener('click', quitarVista);

                if (textoVista) {
                    textoVista.classList.remove('oculto');
                }
            } else {
                console.error('Error al marcar película como vista');
            }
        })
        .catch(error => console.error('Error en la solicitud:', error));
}

function quitarVista() {
    let idPelicula = this.getAttribute('data-idPelicula');
    fetch('index.php?accion=quitar_pelicula_vista&id=' + idPelicula)
        .then(response => response.json())
        .then(data => {
            if (data.respuesta === 'ok') {
                console.log('Vista quitada con éxito');
                actualizarEstadoVista('no_vista');

                let botonVista = document.getElementById('botonVista');
                let textoVista = document.querySelector('.texto-visto');

                botonVista.classList.add('icono-animado');
                setTimeout(() => botonVista.classList.remove('icono-animado'), 300);

                botonVista.classList.remove('quitarVista', 'icono-visto', 'fa-eye');
                botonVista.classList.add('ponerVista', 'icono-no-visto', 'fa-eye-slash');
                botonVista.setAttribute('title', 'Marcar como vista');
                botonVista.removeEventListener('click', quitarVista);
                botonVista.addEventListener('click', ponerVista);

                if (textoVista) {
                    textoVista.classList.add('oculto');
                }
            } else {
                console.error('Error al quitar estado de vista');
            }
        })
        .catch(error => console.error('Error en la solicitud:', error));
}


// Función para actualizar el estado visual de pelicula vista
function actualizarEstadoVista(estado) {
    const estadoVistaContenedor = document.getElementById('estadoVistaContenedor');
    if (estado === 'vista') {
        estadoVistaContenedor.innerHTML = '<strong class="estadoVista text-success">Película Vista</strong>';
    } else {
        estadoVistaContenedor.innerHTML = '';
    }
}








/**
     * Ver todas las películas marcadas como vistas en la base de datos
     */
    public function verTodasPeliculasVistas() {
        // Creamos la conexión utilizando la clase que hemos creado
        $connexionDB = new ConnexionDB(MYSQL_USER, MYSQL_PASS, MYSQL_HOST, MYSQL_DB);
        $conn = $connexionDB->getConnexion();
        
        // Creamos los objetos DAO necesarios para acceder a BBDD a través de estos objetos
        $peliculasDAO = new PeliculasDAO($conn);
        $usuariosDAO = new UsuariosDAO($conn);
        $peliculasVistasDAO = new Peliculas_vistasDAO($conn);

        // Obtener todas las peliculas vistas
        $todasPeliculasVistas = $peliculasVistasDAO->getAllVistasMarcadas();

        foreach ($todasPeliculasVistas as $peliculaVista) {
            $peliculaVista->pelicula = $peliculasDAO->getById($peliculaVista->getIdPelicula()); // Asignar la pelicula a cada pelicula vista
            $peliculaVista->usuario = $usuariosDAO->getById($peliculaVista->getIdUsuario()); // Asignar el usuario a la pelicula vista
        }

        // Pasar las peliculas vistas a la vista(ver_todas_peliculas_vistas.php)
        $peliculasVistas = $todasPeliculasVistas;

        require '../app/vistas/ver_todas_peliculas_vistas.php';
    }





<main>
        <h2>Todas las Películas Vistas</h2>
        <?php if (!empty($peliculasVistas)): ?>
            <?php foreach ($peliculasVistas as $peliculaVista): ?>
                <div class="pelicula_vista" style="display: flex; align-items: center; gap: 20px; border: 1px solid #ccc; padding: 10px; border-radius: 10px;">
                    <div class="foto">
                        <img src="../web/images/<?= $peliculaVista->pelicula->getFoto() ?>" style="height: 150px; border: 1px solid black; border-radius: 8px;">
                    </div>
                    <div class="info" style="display: flex; flex-direction: column;">
                        <h3 class="titulo" style="margin: 0 0 10px 0;"><?= $peliculaVista->pelicula->getTitulo() ?></h3>
                        <p class="fecha" style="margin: 0 0 10px 0;"><u>Película visualizada en:</u> <?= $peliculaVista->getFechaVista() ?></p>
                        <strong style="margin: 0;">Película Vista por: <?= $peliculaVista->usuario->getEmail() ?></strong>
                    </div>
                    <hr>
                </div>
                <br>
            <?php endforeach; ?>
        <?php else: ?>
            <p>No hay películas vistas actualmente.</p>
        <?php endif; ?>

        <br><br>
        <a href="index.php">Volver al listado de Categorías</a>
    </main>

















